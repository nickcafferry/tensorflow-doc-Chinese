

<!DOCTYPE html>
<html class="writer-html5" lang="Chinese" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tensorflow.python.ops.gen_string_ops &mdash; tensorflow 0.1.3 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../_static/GCC.png"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> tensorflow
          

          
            
            <img src="../../../../_static/GCC.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">从TensorFlow开始 (Getting Started)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html">TensorFlow如何工作</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id1">变量和张量的声明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id2">使用占位符和变量</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id3">矩阵</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id4">操作符的声明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id5">载入激活函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id6">数据资源</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id7">资源库</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../01_Introduction/index.html#id8">本章学习模块</a></li>
</ul>
<p class="caption"><span class="caption-text">TensorFlow方式 (TensorFlow Way)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html">计算图</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id2">分层嵌套操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id3">多层操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id4">载入损失函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id5">载入反向传播</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id6">随机和批量训练</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id7">结合训练</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id8">模型评估</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../02_TensorFlow_Way/index.html#id9">本章学习模块</a></li>
</ul>
<p class="caption"><span class="caption-text">线性回归 (Linear Regression)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html">矩阵转置</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#id2">矩阵分解法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#tensorflow">TensorFLow的线性回归</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#id3">线性回归的损失函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#deming">Deming回归(全回归)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#lasso-ridge">套索(Lasso)回归和岭(Ridge)回归</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#elastic-net">弹性网(Elastic Net)回归</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#logistic">逻辑(Logistic)回归</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../03_Linear_Regression/index.html#id4">本章学习模块</a></li>
</ul>
<p class="caption"><span class="caption-text">支持向量机(Support Vector Machines)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../04_Support_Vector_Machines/index.html">引言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../04_Support_Vector_Machines/index.html#id2">线性支持向量机</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../04_Support_Vector_Machines/index.html#id3">回归线性回归</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../04_Support_Vector_Machines/index.html#tensorflow">TensorFlow中的核</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../04_Support_Vector_Machines/index.html#id4">非线性支持向量机</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../04_Support_Vector_Machines/index.html#id5">多类支持向量机</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../04_Support_Vector_Machines/index.html#id6">本章学习模块</a></li>
</ul>
<p class="caption"><span class="caption-text">最近邻法 (Nearest Neighbor Methods)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../05_Nearest_Neighbor_Methods/index.html">引言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../05_Nearest_Neighbor_Methods/index.html#id2">最近邻法的使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../05_Nearest_Neighbor_Methods/index.html#id3">文本距离函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../05_Nearest_Neighbor_Methods/index.html#id4">计算混合距离函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../05_Nearest_Neighbor_Methods/index.html#id5">地址匹配</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../05_Nearest_Neighbor_Methods/index.html#id6">图像处理的近邻法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../05_Nearest_Neighbor_Methods/index.html#id7">本章学习模块</a></li>
</ul>
<p class="caption"><span class="caption-text">神经元网络 (Neural Networks)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html">引言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id2">载入操作门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id3">门运算和激活函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id4">载入一层神经网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id5">载入多层神经网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id6">使用多层神经网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id7">线性模型预测改善</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id8">神经网络学习井字棋</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../06_Neural_Networks/index.html#id9">本章学习模块</a></li>
</ul>
<p class="caption"><span class="caption-text">自然语言处理(NLP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html">引言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#bag-of-words">词袋 (Bag of Words)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#tf-idf">词频-逆文本频率 (TF-IDF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#skip-gram">运用Skip-Gram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#cbow-continuous-bag-fo-words">CBOW (Continuous Bag fo Words)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#word2vec">Word2Vec应用实例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#doc2vec-sentiment-analysis">Doc2Vec情感分析 (Sentiment Analysis)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#id2">神经网络学习井字棋</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../07_Natural_Language_Processing/index.html#id3">本章学习模块</a></li>
</ul>
<p class="caption"><span class="caption-text">卷积神经网络(CNN)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../08_Convolutional_Neural_Networks/index.html">引言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../08_Convolutional_Neural_Networks/index.html#simple-cnns">简单卷积神经网络 (Simple CNNs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../08_Convolutional_Neural_Networks/index.html#advanced-cnns">高级卷积神经网络 (Advanced CNNs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../08_Convolutional_Neural_Networks/index.html#id2">重新训练一个存在架构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../08_Convolutional_Neural_Networks/index.html#stylenet-neural-style">使用Stylenet/Neural-Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../08_Convolutional_Neural_Networks/index.html#deep-dream">运用Deep Dream</a></li>
</ul>
<p class="caption"><span class="caption-text">递归神经网络(RNN)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../09_Recurrent_Neural_Networks/index.html">引言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../09_Recurrent_Neural_Networks/index.html#id2">卷积神经网络模型用于垃圾信息检测</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../09_Recurrent_Neural_Networks/index.html#lstm">LSTM模型用于文本生成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../09_Recurrent_Neural_Networks/index.html#id3">堆叠多层LSTM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../09_Recurrent_Neural_Networks/index.html#seq2seq">创建段对段模型翻译 (Seq2Seq)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../09_Recurrent_Neural_Networks/index.html#siamese">训练Siamese相似度测量</a></li>
</ul>
<p class="caption"><span class="caption-text">TensorFlow的应用技巧</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../10_Taking_TensorFlow_to_Production/index.html">单元测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../10_Taking_TensorFlow_to_Production/index.html#id2">使用多个执行器 (设备)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../10_Taking_TensorFlow_to_Production/index.html#tensorflow">TensorFlow平行化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../10_Taking_TensorFlow_to_Production/index.html#id3">TensorFlow开发贴士</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../10_Taking_TensorFlow_to_Production/index.html#id4">TensorFlow开发实例</a></li>
</ul>
<p class="caption"><span class="caption-text">TensorFlow的更多功能</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../11_More_with_TensorFlow/index.html">计算图可视化(用Tensorboard)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../11_More_with_TensorFlow/index.html#id1">遗传算法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../11_More_with_TensorFlow/index.html#k-means">K-means聚类分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../11_More_with_TensorFlow/index.html#id2">解决体系常微分方程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../11_More_with_TensorFlow/index.html#id3">随机森林</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../11_More_with_TensorFlow/index.html#tensorflowkeras">TensorFlow中的Keras</a></li>
</ul>
<p class="caption"><span class="caption-text">TF Cookbook</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html">书籍介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id2">第一章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id3">第二章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id4">第三章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id5">第四章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id6">第五章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id7">第六章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id8">第七章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id9">第八章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id10">第九章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id11">第十章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id12">第十一章</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bookindex.html#id13">索引</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">tensorflow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>tensorflow.python.ops.gen_string_ops</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for tensorflow.python.ops.gen_string_ops</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Python wrappers around TensorFlow ops.</span>

<span class="sd">This file is MACHINE GENERATED! Do not edit.</span>
<span class="sd">Original C++ source file: string_ops.cc</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">collections</span>

<span class="kn">from</span> <span class="nn">tensorflow.python</span> <span class="k">import</span> <span class="n">pywrap_tfe</span> <span class="k">as</span> <span class="n">pywrap_tfe</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.eager</span> <span class="k">import</span> <span class="n">context</span> <span class="k">as</span> <span class="n">_context</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.eager</span> <span class="k">import</span> <span class="n">core</span> <span class="k">as</span> <span class="n">_core</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.eager</span> <span class="k">import</span> <span class="n">execute</span> <span class="k">as</span> <span class="n">_execute</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.framework</span> <span class="k">import</span> <span class="n">dtypes</span> <span class="k">as</span> <span class="n">_dtypes</span>

<span class="kn">from</span> <span class="nn">tensorflow.python.framework</span> <span class="k">import</span> <span class="n">op_def_registry</span> <span class="k">as</span> <span class="n">_op_def_registry</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.framework</span> <span class="k">import</span> <span class="n">ops</span> <span class="k">as</span> <span class="n">_ops</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.framework</span> <span class="k">import</span> <span class="n">op_def_library</span> <span class="k">as</span> <span class="n">_op_def_library</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.util.deprecation</span> <span class="k">import</span> <span class="n">deprecated_endpoints</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.util</span> <span class="k">import</span> <span class="n">dispatch</span> <span class="k">as</span> <span class="n">_dispatch</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.util.tf_export</span> <span class="k">import</span> <span class="n">tf_export</span>


<div class="viewcode-block" id="as_string"><a class="viewcode-back" href="../../../../index.html#tensorflow.as_string">[docs]</a><span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.as_string&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">,</span> <span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dtypes.as_string&#39;</span><span class="p">,</span> <span class="s1">&#39;strings.as_string&#39;</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">])</span>
<span class="nd">@deprecated_endpoints</span><span class="p">(</span><span class="s1">&#39;dtypes.as_string&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">as_string</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">precision</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scientific</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shortest</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Converts each entry in the given tensor to strings.</span>

<span class="sd">  Supports many numeric types and boolean.</span>

<span class="sd">  For Unicode, see the</span>
<span class="sd">  [https://www.tensorflow.org/tutorials/representation/unicode](Working with Unicode text)</span>
<span class="sd">  tutorial.</span>

<span class="sd">  Examples:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.as_string([3, 2])</span>
<span class="sd">  &lt;tf.Tensor: shape=(2,), dtype=string, numpy=array([b&#39;3&#39;, b&#39;2&#39;], dtype=object)&gt;</span>
<span class="sd">  &gt;&gt;&gt; tf.strings.as_string([3.1415926, 2.71828], precision=2).numpy()</span>
<span class="sd">  array([b&#39;3.14&#39;, b&#39;2.72&#39;], dtype=object)</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor`. Must be one of the following types: `int8`, `int16`, `int32`, `int64`, `complex64`, `complex128`, `float32`, `float64`, `bool`.</span>
<span class="sd">    precision: An optional `int`. Defaults to `-1`.</span>
<span class="sd">      The post-decimal precision to use for floating point numbers.</span>
<span class="sd">      Only used if precision &gt; -1.</span>
<span class="sd">    scientific: An optional `bool`. Defaults to `False`.</span>
<span class="sd">      Use scientific notation for floating point numbers.</span>
<span class="sd">    shortest: An optional `bool`. Defaults to `False`.</span>
<span class="sd">      Use shortest representation (either scientific or standard) for</span>
<span class="sd">      floating point numbers.</span>
<span class="sd">    width: An optional `int`. Defaults to `-1`.</span>
<span class="sd">      Pad pre-decimal numbers to this width.</span>
<span class="sd">      Applies to both floating point and integer numbers.</span>
<span class="sd">      Only used if width &gt; -1.</span>
<span class="sd">    fill: An optional `string`. Defaults to `&quot;&quot;`.</span>
<span class="sd">      The value to pad if width &gt; -1.  If empty, pads with spaces.</span>
<span class="sd">      Another typical value is &#39;0&#39;.  String cannot be longer than 1 character.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;AsString&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;scientific&quot;</span><span class="p">,</span>
        <span class="n">scientific</span><span class="p">,</span> <span class="s2">&quot;shortest&quot;</span><span class="p">,</span> <span class="n">shortest</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">as_string_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">scientific</span><span class="o">=</span><span class="n">scientific</span><span class="p">,</span>
            <span class="n">shortest</span><span class="o">=</span><span class="n">shortest</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">as_string</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span>
                         <span class="n">scientific</span><span class="o">=</span><span class="n">scientific</span><span class="p">,</span> <span class="n">shortest</span><span class="o">=</span><span class="n">shortest</span><span class="p">,</span>
                         <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">precision</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="n">precision</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">scientific</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">scientific</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">scientific</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">scientific</span><span class="p">,</span> <span class="s2">&quot;scientific&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">shortest</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">shortest</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">shortest</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">shortest</span><span class="p">,</span> <span class="s2">&quot;shortest&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">width</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="n">width</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fill</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">fill</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="s2">&quot;fill&quot;</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;AsString&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">scientific</span><span class="o">=</span><span class="n">scientific</span><span class="p">,</span>
                    <span class="n">shortest</span><span class="o">=</span><span class="n">shortest</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">as_string</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">scientific</span><span class="o">=</span><span class="n">scientific</span><span class="p">,</span>
                     <span class="n">shortest</span><span class="o">=</span><span class="n">shortest</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">),</span> <span class="s2">&quot;precision&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;precision&quot;</span><span class="p">),</span> <span class="s2">&quot;scientific&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;scientific&quot;</span><span class="p">),</span> <span class="s2">&quot;shortest&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;shortest&quot;</span><span class="p">),</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">),</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;AsString&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span></div>

<span class="n">AsString</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.AsString&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">as_string</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">as_string_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">scientific</span><span class="p">,</span> <span class="n">shortest</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">precision</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="n">precision</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">scientific</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">scientific</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">scientific</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">scientific</span><span class="p">,</span> <span class="s2">&quot;scientific&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">shortest</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">shortest</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">shortest</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">shortest</span><span class="p">,</span> <span class="s2">&quot;shortest&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">width</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="n">width</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fill</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">fill</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="s2">&quot;fill&quot;</span><span class="p">)</span>
  <span class="n">_attr_T</span><span class="p">,</span> <span class="p">(</span><span class="nb">input</span><span class="p">,)</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">args_to_matching_eager</span><span class="p">([</span><span class="nb">input</span><span class="p">],</span> <span class="n">ctx</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">_attr_T</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;scientific&quot;</span><span class="p">,</span> <span class="n">scientific</span><span class="p">,</span>
  <span class="s2">&quot;shortest&quot;</span><span class="p">,</span> <span class="n">shortest</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;AsString&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;AsString&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;io.decode_base64&#39;</span><span class="p">,</span> <span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;io.decode_base64&#39;</span><span class="p">,</span> <span class="s1">&#39;decode_base64&#39;</span><span class="p">])</span>
<span class="nd">@deprecated_endpoints</span><span class="p">(</span><span class="s1">&#39;decode_base64&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">decode_base64</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Decode web-safe base64-encoded strings.</span>

<span class="sd">  Input may or may not have padding at the end. See EncodeBase64 for padding.</span>
<span class="sd">  Web-safe means that input must use - and _ instead of + and /.</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. Base64 strings to decode.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;DecodeBase64&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">decode_base64_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">decode_base64</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;DecodeBase64&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">decode_base64</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;DecodeBase64&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">DecodeBase64</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.DecodeBase64&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">decode_base64</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">decode_base64_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;DecodeBase64&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;DecodeBase64&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;io.encode_base64&#39;</span><span class="p">,</span> <span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;io.encode_base64&#39;</span><span class="p">,</span> <span class="s1">&#39;encode_base64&#39;</span><span class="p">])</span>
<span class="nd">@deprecated_endpoints</span><span class="p">(</span><span class="s1">&#39;encode_base64&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">encode_base64</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Encode strings into web-safe base64 format.</span>

<span class="sd">  Refer to the following article for more information on base64 format:</span>
<span class="sd">  en.wikipedia.org/wiki/Base64. Base64 strings may have padding with &#39;=&#39; at the</span>
<span class="sd">  end so that the encoded has length multiple of 4. See Padding section of the</span>
<span class="sd">  link above.</span>

<span class="sd">  Web-safe means that the encoder uses - and _ instead of + and /.</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. Strings to be encoded.</span>
<span class="sd">    pad: An optional `bool`. Defaults to `False`.</span>
<span class="sd">      Bool whether padding is applied at the ends.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;EncodeBase64&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;pad&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">encode_base64_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">encode_base64</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">pad</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="s2">&quot;pad&quot;</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;EncodeBase64&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">encode_base64</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pad&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;pad&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;EncodeBase64&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">EncodeBase64</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.EncodeBase64&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">encode_base64</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">encode_base64_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">pad</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="s2">&quot;pad&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pad&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;EncodeBase64&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;EncodeBase64&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">reduce_join</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">reduction_indices</span><span class="p">,</span> <span class="n">keep_dims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Joins a string Tensor across the given dimensions.</span>

<span class="sd">  Computes the string join across dimensions in the given string Tensor of shape</span>
<span class="sd">  `[\\(d_0, d_1, ..., d_{n-1}\\)]`.  Returns a new Tensor created by joining the input</span>
<span class="sd">  strings with the given separator (default: empty string).  Negative indices are</span>
<span class="sd">  counted backwards from the end, with `-1` being equivalent to `n - 1`.  If</span>
<span class="sd">  indices are not specified, joins across all dimensions beginning from `n - 1`</span>
<span class="sd">  through `0`.</span>

<span class="sd">  For example:</span>

<span class="sd">  ```python</span>
<span class="sd">  # tensor `a` is [[&quot;a&quot;, &quot;b&quot;], [&quot;c&quot;, &quot;d&quot;]]</span>
<span class="sd">  tf.reduce_join(a, 0) ==&gt; [&quot;ac&quot;, &quot;bd&quot;]</span>
<span class="sd">  tf.reduce_join(a, 1) ==&gt; [&quot;ab&quot;, &quot;cd&quot;]</span>
<span class="sd">  tf.reduce_join(a, -2) = tf.reduce_join(a, 0) ==&gt; [&quot;ac&quot;, &quot;bd&quot;]</span>
<span class="sd">  tf.reduce_join(a, -1) = tf.reduce_join(a, 1) ==&gt; [&quot;ab&quot;, &quot;cd&quot;]</span>
<span class="sd">  tf.reduce_join(a, 0, keep_dims=True) ==&gt; [[&quot;ac&quot;, &quot;bd&quot;]]</span>
<span class="sd">  tf.reduce_join(a, 1, keep_dims=True) ==&gt; [[&quot;ab&quot;], [&quot;cd&quot;]]</span>
<span class="sd">  tf.reduce_join(a, 0, separator=&quot;.&quot;) ==&gt; [&quot;a.c&quot;, &quot;b.d&quot;]</span>
<span class="sd">  tf.reduce_join(a, [0, 1]) ==&gt; &quot;acbd&quot;</span>
<span class="sd">  tf.reduce_join(a, [1, 0]) ==&gt; &quot;abcd&quot;</span>
<span class="sd">  tf.reduce_join(a, []) ==&gt; [[&quot;a&quot;, &quot;b&quot;], [&quot;c&quot;, &quot;d&quot;]]</span>
<span class="sd">  tf.reduce_join(a) = tf.reduce_join(a, [1, 0]) ==&gt; &quot;abcd&quot;</span>
<span class="sd">  ```</span>

<span class="sd">  Args:</span>
<span class="sd">    inputs: A `Tensor` of type `string`.</span>
<span class="sd">      The input to be joined.  All reduced indices must have non-zero size.</span>
<span class="sd">    reduction_indices: A `Tensor` of type `int32`.</span>
<span class="sd">      The dimensions to reduce over.  Dimensions are reduced in the</span>
<span class="sd">      order specified.  Omitting `reduction_indices` is equivalent to passing</span>
<span class="sd">      `[n-1, n-2, ..., 0]`.  Negative indices from `-n` to `-1` are supported.</span>
<span class="sd">    keep_dims: An optional `bool`. Defaults to `False`.</span>
<span class="sd">      If `True`, retain reduced dimensions with length `1`.</span>
<span class="sd">    separator: An optional `string`. Defaults to `&quot;&quot;`.</span>
<span class="sd">      The separator to use when joining.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;ReduceJoin&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">reduction_indices</span><span class="p">,</span> <span class="s2">&quot;keep_dims&quot;</span><span class="p">,</span> <span class="n">keep_dims</span><span class="p">,</span>
        <span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reduce_join_eager_fallback</span><span class="p">(</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">reduction_indices</span><span class="p">,</span> <span class="n">keep_dims</span><span class="o">=</span><span class="n">keep_dims</span><span class="p">,</span>
            <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">keep_dims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">keep_dims</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">keep_dims</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">keep_dims</span><span class="p">,</span> <span class="s2">&quot;keep_dims&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;ReduceJoin&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">reduction_indices</span><span class="o">=</span><span class="n">reduction_indices</span><span class="p">,</span>
                      <span class="n">keep_dims</span><span class="o">=</span><span class="n">keep_dims</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;keep_dims&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;keep_dims&quot;</span><span class="p">),</span> <span class="s2">&quot;separator&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;ReduceJoin&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">ReduceJoin</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.ReduceJoin&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">reduce_join</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">reduce_join_eager_fallback</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">reduction_indices</span><span class="p">,</span> <span class="n">keep_dims</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">keep_dims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">keep_dims</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">keep_dims</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">keep_dims</span><span class="p">,</span> <span class="s2">&quot;keep_dims&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="n">inputs</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">reduction_indices</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">reduction_indices</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputs</span><span class="p">,</span> <span class="n">reduction_indices</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;keep_dims&quot;</span><span class="p">,</span> <span class="n">keep_dims</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;ReduceJoin&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;ReduceJoin&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">regex_full_match</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Check if the input matches the regex pattern.</span>

<span class="sd">  The input is a string tensor of any shape. The pattern is a scalar</span>
<span class="sd">  string tensor which is applied to every element of the input tensor.</span>
<span class="sd">  The boolean values (True or False) of the output tensor indicate</span>
<span class="sd">  if the input matches the regex pattern provided.</span>

<span class="sd">  The pattern follows the re2 syntax (https://github.com/google/re2/wiki/Syntax)</span>

<span class="sd">  Examples:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.regex_full_match([&quot;TF lib&quot;, &quot;lib TF&quot;], &quot;.*lib$&quot;)</span>
<span class="sd">  &lt;tf.Tensor: shape=(2,), dtype=bool, numpy=array([ True, False])&gt;</span>
<span class="sd">  &gt;&gt;&gt; tf.strings.regex_full_match([&quot;TF lib&quot;, &quot;lib TF&quot;], &quot;.*TF$&quot;)</span>
<span class="sd">  &lt;tf.Tensor: shape=(2,), dtype=bool, numpy=array([False,  True])&gt;</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">      A string tensor of the text to be processed.</span>
<span class="sd">    pattern: A `Tensor` of type `string`.</span>
<span class="sd">      A scalar string tensor containing the regular expression to match the input.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `bool`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;RegexFullMatch&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">regex_full_match_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;RegexFullMatch&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;RegexFullMatch&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">RegexFullMatch</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.RegexFullMatch&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">regex_full_match</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">regex_full_match_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">pattern</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;RegexFullMatch&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;RegexFullMatch&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">regex_replace</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span> <span class="n">replace_global</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Replaces matches of the `pattern` regular expression in `input` with the</span>
<span class="sd">replacement string provided in `rewrite`.</span>

<span class="sd">  It follows the re2 syntax (https://github.com/google/re2/wiki/Syntax)</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. The text to be processed.</span>
<span class="sd">    pattern: A `Tensor` of type `string`.</span>
<span class="sd">      The regular expression to be matched in the `input` strings.</span>
<span class="sd">    rewrite: A `Tensor` of type `string`.</span>
<span class="sd">      The rewrite string to be substituted for the `pattern` expression where it is</span>
<span class="sd">      matched in the `input` strings.</span>
<span class="sd">    replace_global: An optional `bool`. Defaults to `True`.</span>
<span class="sd">      If True, the replacement is global (that is, all matches of the `pattern` regular</span>
<span class="sd">      expression in each input string are rewritten), otherwise the `rewrite`</span>
<span class="sd">      substitution is only made for the first `pattern` match.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;RegexReplace&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span> <span class="s2">&quot;replace_global&quot;</span><span class="p">,</span>
        <span class="n">replace_global</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">regex_replace_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span> <span class="n">replace_global</span><span class="o">=</span><span class="n">replace_global</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">replace_global</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_global</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="n">replace_global</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_global</span><span class="p">,</span> <span class="s2">&quot;replace_global&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;RegexReplace&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="o">=</span><span class="n">rewrite</span><span class="p">,</span>
                        <span class="n">replace_global</span><span class="o">=</span><span class="n">replace_global</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;replace_global&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;replace_global&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;RegexReplace&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">RegexReplace</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.RegexReplace&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">regex_replace</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">regex_replace_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span> <span class="n">replace_global</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">replace_global</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_global</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="n">replace_global</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_global</span><span class="p">,</span> <span class="s2">&quot;replace_global&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">pattern</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">rewrite</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">rewrite</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;replace_global&quot;</span><span class="p">,</span> <span class="n">replace_global</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;RegexReplace&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;RegexReplace&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">static_regex_full_match</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Check if the input matches the regex pattern.</span>

<span class="sd">  The input is a string tensor of any shape. The pattern is the</span>
<span class="sd">  regular expression to be matched with every element of the input tensor.</span>
<span class="sd">  The boolean values (True or False) of the output tensor indicate</span>
<span class="sd">  if the input matches the regex pattern provided.</span>

<span class="sd">  The pattern follows the re2 syntax (https://github.com/google/re2/wiki/Syntax)</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">      A string tensor of the text to be processed.</span>
<span class="sd">    pattern: A `string`. The regular expression to match the input.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `bool`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StaticRegexFullMatch&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">static_regex_full_match_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">pattern</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StaticRegexFullMatch&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StaticRegexFullMatch&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StaticRegexFullMatch</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StaticRegexFullMatch&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">static_regex_full_match</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">static_regex_full_match_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">pattern</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StaticRegexFullMatch&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StaticRegexFullMatch&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">static_regex_replace</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span> <span class="n">replace_global</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Replaces the match of pattern in input with rewrite.</span>

<span class="sd">  It follows the re2 syntax (https://github.com/google/re2/wiki/Syntax)</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. The text to be processed.</span>
<span class="sd">    pattern: A `string`. The regular expression to match the input.</span>
<span class="sd">    rewrite: A `string`. The rewrite to be applied to the matched expression.</span>
<span class="sd">    replace_global: An optional `bool`. Defaults to `True`.</span>
<span class="sd">      If True, the replacement is global, otherwise the replacement</span>
<span class="sd">      is done only on the first match.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StaticRegexReplace&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;rewrite&quot;</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span>
        <span class="s2">&quot;replace_global&quot;</span><span class="p">,</span> <span class="n">replace_global</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">static_regex_replace_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="o">=</span><span class="n">rewrite</span><span class="p">,</span>
            <span class="n">replace_global</span><span class="o">=</span><span class="n">replace_global</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">pattern</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">)</span>
  <span class="n">rewrite</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">rewrite</span><span class="p">,</span> <span class="s2">&quot;rewrite&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_global</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_global</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="n">replace_global</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_global</span><span class="p">,</span> <span class="s2">&quot;replace_global&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StaticRegexReplace&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="o">=</span><span class="n">rewrite</span><span class="p">,</span>
                              <span class="n">replace_global</span><span class="o">=</span><span class="n">replace_global</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">),</span> <span class="s2">&quot;rewrite&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;rewrite&quot;</span><span class="p">),</span> <span class="s2">&quot;replace_global&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;replace_global&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StaticRegexReplace&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StaticRegexReplace</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StaticRegexReplace&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">static_regex_replace</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">static_regex_replace_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span> <span class="n">replace_global</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">pattern</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">)</span>
  <span class="n">rewrite</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">rewrite</span><span class="p">,</span> <span class="s2">&quot;rewrite&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_global</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_global</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="n">replace_global</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_global</span><span class="p">,</span> <span class="s2">&quot;replace_global&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;rewrite&quot;</span><span class="p">,</span> <span class="n">rewrite</span><span class="p">,</span> <span class="s2">&quot;replace_global&quot;</span><span class="p">,</span>
  <span class="n">replace_global</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StaticRegexReplace&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StaticRegexReplace&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">string_format</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">summarize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Formats a string template using a list of tensors.</span>

<span class="sd">  Formats a string template using a list of tensors, pretty-printing tensor summaries.</span>

<span class="sd">  Args:</span>
<span class="sd">    inputs: A list of `Tensor` objects.</span>
<span class="sd">      The list of tensors to format into the placeholder string.</span>
<span class="sd">    template: An optional `string`. Defaults to `&quot;%s&quot;`.</span>
<span class="sd">      A string, the template to format tensor summaries into.</span>
<span class="sd">    placeholder: An optional `string`. Defaults to `&quot;%s&quot;`.</span>
<span class="sd">      A string, at each placeholder in the template a subsequent tensor summary will be inserted.</span>
<span class="sd">    summarize: An optional `int`. Defaults to `3`.</span>
<span class="sd">      When formatting the tensor summaries print the first and last summarize entries of each tensor dimension.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringFormat&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">,</span>
        <span class="n">placeholder</span><span class="p">,</span> <span class="s2">&quot;summarize&quot;</span><span class="p">,</span> <span class="n">summarize</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_format_eager_fallback</span><span class="p">(</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span> <span class="n">placeholder</span><span class="o">=</span><span class="n">placeholder</span><span class="p">,</span>
            <span class="n">summarize</span><span class="o">=</span><span class="n">summarize</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
  <span class="n">template</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">placeholder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">placeholder</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
  <span class="n">placeholder</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">placeholder</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">summarize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">summarize</span> <span class="o">=</span> <span class="mi">3</span>
  <span class="n">summarize</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">summarize</span><span class="p">,</span> <span class="s2">&quot;summarize&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringFormat&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span>
                        <span class="n">placeholder</span><span class="o">=</span><span class="n">placeholder</span><span class="p">,</span> <span class="n">summarize</span><span class="o">=</span><span class="n">summarize</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">),</span> <span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">),</span>
              <span class="s2">&quot;placeholder&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">),</span> <span class="s2">&quot;summarize&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;summarize&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringFormat&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringFormat</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringFormat&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_format</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_format_eager_fallback</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">placeholder</span><span class="p">,</span> <span class="n">summarize</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
  <span class="n">template</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">placeholder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">placeholder</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
  <span class="n">placeholder</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">placeholder</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">summarize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">summarize</span> <span class="o">=</span> <span class="mi">3</span>
  <span class="n">summarize</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">summarize</span><span class="p">,</span> <span class="s2">&quot;summarize&quot;</span><span class="p">)</span>
  <span class="n">_attr_T</span><span class="p">,</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">convert_to_mixed_eager_tensors</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">_attr_T</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">,</span> <span class="n">placeholder</span><span class="p">,</span>
  <span class="s2">&quot;summarize&quot;</span><span class="p">,</span> <span class="n">summarize</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringFormat&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringFormat&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">string_join</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Joins the strings in the given list of string tensors into one tensor;</span>

<span class="sd">  with the given separator (default is an empty separator).</span>

<span class="sd">  Examples:</span>

<span class="sd">  &gt;&gt;&gt; s = [&quot;hello&quot;, &quot;world&quot;, &quot;tensorflow&quot;]</span>
<span class="sd">  &gt;&gt;&gt; tf.strings.join(s, &quot; &quot;)</span>
<span class="sd">  &lt;tf.Tensor: shape=(), dtype=string, numpy=b&#39;hello world tensorflow&#39;&gt;</span>

<span class="sd">  Args:</span>
<span class="sd">    inputs: A list of at least 1 `Tensor` objects with type `string`.</span>
<span class="sd">      A list of string tensors.  The tensors must all have the same shape,</span>
<span class="sd">      or be scalars.  Scalars may be mixed in; these will be broadcast to the shape</span>
<span class="sd">      of non-scalar inputs.</span>
<span class="sd">    separator: An optional `string`. Defaults to `&quot;&quot;`.</span>
<span class="sd">      string, an optional join separator.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringJoin&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_join_eager_fallback</span><span class="p">(</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
        <span class="s2">&quot;Expected list for &#39;inputs&#39; argument to &quot;</span>
        <span class="s2">&quot;&#39;string_join&#39; Op, not </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">inputs</span><span class="p">)</span>
  <span class="n">_attr_N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringJoin&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">),</span> <span class="s2">&quot;separator&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringJoin&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringJoin</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringJoin&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_join</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_join_eager_fallback</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
        <span class="s2">&quot;Expected list for &#39;inputs&#39; argument to &quot;</span>
        <span class="s2">&quot;&#39;string_join&#39; Op, not </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">inputs</span><span class="p">)</span>
  <span class="n">_attr_N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="n">inputs</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_n_to_tensor</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">_attr_N</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringJoin&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringJoin&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">string_length</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;BYTE&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;String lengths of `input`.</span>

<span class="sd">  Computes the length of each string given in the input tensor.</span>

<span class="sd">  &gt;&gt;&gt; strings = tf.constant([&#39;Hello&#39;,&#39;TensorFlow&#39;, &#39;\U0001F642&#39;])</span>
<span class="sd">  &gt;&gt;&gt; tf.strings.length(strings).numpy() # default counts bytes</span>
<span class="sd">  array([ 5, 10, 4], dtype=int32)</span>
<span class="sd">  &gt;&gt;&gt; tf.strings.length(strings, unit=&quot;UTF8_CHAR&quot;).numpy()</span>
<span class="sd">  array([ 5, 10, 1], dtype=int32)</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">      The strings for which to compute the length for each element.</span>
<span class="sd">    unit: An optional `string` from: `&quot;BYTE&quot;, &quot;UTF8_CHAR&quot;`. Defaults to `&quot;BYTE&quot;`.</span>
<span class="sd">      The unit that is counted to compute string length.  One of: `&quot;BYTE&quot;` (for</span>
<span class="sd">      the number of bytes in each string) or `&quot;UTF8_CHAR&quot;` (for the number of UTF-8</span>
<span class="sd">      encoded Unicode code points in each string).  Results are undefined</span>
<span class="sd">      if `unit=UTF8_CHAR` and the `input` strings do not contain structurally</span>
<span class="sd">      valid UTF-8.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `int32`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringLength&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_length_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;BYTE&quot;</span>
  <span class="n">unit</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringLength&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringLength&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringLength</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringLength&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_length</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_length_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;BYTE&quot;</span>
  <span class="n">unit</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringLength&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringLength&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.lower&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">string_lower</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Converts all uppercase characters into their respective lowercase replacements.</span>

<span class="sd">  Example:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.lower(&quot;CamelCase string and ALL CAPS&quot;)</span>
<span class="sd">  &lt;tf.Tensor: shape=(), dtype=string, numpy=b&#39;camelcase string and all caps&#39;&gt;</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">    encoding: An optional `string`. Defaults to `&quot;&quot;`.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringLower&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_lower_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">string_lower</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringLower&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">string_lower</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringLower&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringLower</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringLower&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_lower</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_lower_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringLower&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringLower&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">_StringNGramsOutput</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s2">&quot;StringNGrams&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;ngrams&quot;</span><span class="p">,</span> <span class="s2">&quot;ngrams_splits&quot;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">string_n_grams</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_splits</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">ngram_widths</span><span class="p">,</span> <span class="n">left_pad</span><span class="p">,</span> <span class="n">right_pad</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">,</span> <span class="n">preserve_short_sequences</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Creates ngrams from ragged string data.</span>

<span class="sd">  This op accepts a ragged tensor with 1 ragged dimension containing only</span>
<span class="sd">  strings and outputs a ragged tensor with 1 ragged dimension containing ngrams</span>
<span class="sd">  of that string, joined along the innermost axis.</span>

<span class="sd">  Args:</span>
<span class="sd">    data: A `Tensor` of type `string`.</span>
<span class="sd">      The values tensor of the ragged string tensor to make ngrams out of. Must be a</span>
<span class="sd">      1D string tensor.</span>
<span class="sd">    data_splits: A `Tensor`. Must be one of the following types: `int32`, `int64`.</span>
<span class="sd">      The splits tensor of the ragged string tensor to make ngrams out of.</span>
<span class="sd">    separator: A `string`.</span>
<span class="sd">      The string to append between elements of the token. Use &quot;&quot; for no separator.</span>
<span class="sd">    ngram_widths: A list of `ints`. The sizes of the ngrams to create.</span>
<span class="sd">    left_pad: A `string`.</span>
<span class="sd">      The string to use to pad the left side of the ngram sequence. Only used if</span>
<span class="sd">      pad_width != 0.</span>
<span class="sd">    right_pad: A `string`.</span>
<span class="sd">      The string to use to pad the right side of the ngram sequence. Only used if</span>
<span class="sd">      pad_width != 0.</span>
<span class="sd">    pad_width: An `int`.</span>
<span class="sd">      The number of padding elements to add to each side of each</span>
<span class="sd">      sequence. Note that padding will never be greater than &#39;ngram_widths&#39;-1</span>
<span class="sd">      regardless of this value. If `pad_width=-1`, then add `max(ngram_widths)-1`</span>
<span class="sd">      elements.</span>
<span class="sd">    preserve_short_sequences: A `bool`.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A tuple of `Tensor` objects (ngrams, ngrams_splits).</span>

<span class="sd">    ngrams: A `Tensor` of type `string`.</span>
<span class="sd">    ngrams_splits: A `Tensor`. Has the same type as `data_splits`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringNGrams&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">data_splits</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span>
        <span class="s2">&quot;ngram_widths&quot;</span><span class="p">,</span> <span class="n">ngram_widths</span><span class="p">,</span> <span class="s2">&quot;left_pad&quot;</span><span class="p">,</span> <span class="n">left_pad</span><span class="p">,</span> <span class="s2">&quot;right_pad&quot;</span><span class="p">,</span>
        <span class="n">right_pad</span><span class="p">,</span> <span class="s2">&quot;pad_width&quot;</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">,</span> <span class="s2">&quot;preserve_short_sequences&quot;</span><span class="p">,</span>
        <span class="n">preserve_short_sequences</span><span class="p">)</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringNGramsOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_n_grams_eager_fallback</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">data_splits</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">ngram_widths</span><span class="o">=</span><span class="n">ngram_widths</span><span class="p">,</span>
            <span class="n">left_pad</span><span class="o">=</span><span class="n">left_pad</span><span class="p">,</span> <span class="n">right_pad</span><span class="o">=</span><span class="n">right_pad</span><span class="p">,</span> <span class="n">pad_width</span><span class="o">=</span><span class="n">pad_width</span><span class="p">,</span>
            <span class="n">preserve_short_sequences</span><span class="o">=</span><span class="n">preserve_short_sequences</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ngram_widths</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
        <span class="s2">&quot;Expected list for &#39;ngram_widths&#39; argument to &quot;</span>
        <span class="s2">&quot;&#39;string_n_grams&#39; Op, not </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">ngram_widths</span><span class="p">)</span>
  <span class="n">ngram_widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">_i</span><span class="p">,</span> <span class="s2">&quot;ngram_widths&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">ngram_widths</span><span class="p">]</span>
  <span class="n">left_pad</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">left_pad</span><span class="p">,</span> <span class="s2">&quot;left_pad&quot;</span><span class="p">)</span>
  <span class="n">right_pad</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">right_pad</span><span class="p">,</span> <span class="s2">&quot;right_pad&quot;</span><span class="p">)</span>
  <span class="n">pad_width</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="s2">&quot;pad_width&quot;</span><span class="p">)</span>
  <span class="n">preserve_short_sequences</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">preserve_short_sequences</span><span class="p">,</span> <span class="s2">&quot;preserve_short_sequences&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringNGrams&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">data_splits</span><span class="o">=</span><span class="n">data_splits</span><span class="p">,</span>
                        <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">ngram_widths</span><span class="o">=</span><span class="n">ngram_widths</span><span class="p">,</span>
                        <span class="n">left_pad</span><span class="o">=</span><span class="n">left_pad</span><span class="p">,</span> <span class="n">right_pad</span><span class="o">=</span><span class="n">right_pad</span><span class="p">,</span>
                        <span class="n">pad_width</span><span class="o">=</span><span class="n">pad_width</span><span class="p">,</span>
                        <span class="n">preserve_short_sequences</span><span class="o">=</span><span class="n">preserve_short_sequences</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">),</span> <span class="s2">&quot;ngram_widths&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;ngram_widths&quot;</span><span class="p">),</span> <span class="s2">&quot;left_pad&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;left_pad&quot;</span><span class="p">),</span> <span class="s2">&quot;right_pad&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;right_pad&quot;</span><span class="p">),</span> <span class="s2">&quot;pad_width&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;pad_width&quot;</span><span class="p">),</span> <span class="s2">&quot;preserve_short_sequences&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;preserve_short_sequences&quot;</span><span class="p">),</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;Tsplits&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringNGrams&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringNGramsOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringNGrams</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringNGrams&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_n_grams</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_n_grams_eager_fallback</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_splits</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">ngram_widths</span><span class="p">,</span> <span class="n">left_pad</span><span class="p">,</span> <span class="n">right_pad</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">,</span> <span class="n">preserve_short_sequences</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ngram_widths</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
        <span class="s2">&quot;Expected list for &#39;ngram_widths&#39; argument to &quot;</span>
        <span class="s2">&quot;&#39;string_n_grams&#39; Op, not </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">ngram_widths</span><span class="p">)</span>
  <span class="n">ngram_widths</span> <span class="o">=</span> <span class="p">[</span><span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">_i</span><span class="p">,</span> <span class="s2">&quot;ngram_widths&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">ngram_widths</span><span class="p">]</span>
  <span class="n">left_pad</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">left_pad</span><span class="p">,</span> <span class="s2">&quot;left_pad&quot;</span><span class="p">)</span>
  <span class="n">right_pad</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">right_pad</span><span class="p">,</span> <span class="s2">&quot;right_pad&quot;</span><span class="p">)</span>
  <span class="n">pad_width</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="s2">&quot;pad_width&quot;</span><span class="p">)</span>
  <span class="n">preserve_short_sequences</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">preserve_short_sequences</span><span class="p">,</span> <span class="s2">&quot;preserve_short_sequences&quot;</span><span class="p">)</span>
  <span class="n">_attr_Tsplits</span><span class="p">,</span> <span class="p">(</span><span class="n">data_splits</span><span class="p">,)</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">args_to_matching_eager</span><span class="p">([</span><span class="n">data_splits</span><span class="p">],</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">data_splits</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;ngram_widths&quot;</span><span class="p">,</span> <span class="n">ngram_widths</span><span class="p">,</span> <span class="s2">&quot;left_pad&quot;</span><span class="p">,</span>
  <span class="n">left_pad</span><span class="p">,</span> <span class="s2">&quot;right_pad&quot;</span><span class="p">,</span> <span class="n">right_pad</span><span class="p">,</span> <span class="s2">&quot;pad_width&quot;</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">,</span>
  <span class="s2">&quot;preserve_short_sequences&quot;</span><span class="p">,</span> <span class="n">preserve_short_sequences</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span>
  <span class="n">_attr_Tsplits</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringNGrams&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringNGrams&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringNGramsOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">_StringSplitOutput</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s2">&quot;StringSplit&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">,</span> <span class="s2">&quot;values&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">string_split</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">skip_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Split elements of `input` based on `delimiter` into a `SparseTensor`.</span>

<span class="sd">  Let N be the size of source (typically N will be the batch size). Split each</span>
<span class="sd">  element of `input` based on `delimiter` and return a `SparseTensor`</span>
<span class="sd">  containing the splitted tokens. Empty tokens are ignored.</span>

<span class="sd">  `delimiter` can be empty, or a string of split characters. If `delimiter` is an</span>
<span class="sd">   empty string, each element of `input` is split into individual single-byte</span>
<span class="sd">   character strings, including splitting of UTF-8 multibyte sequences. Otherwise</span>
<span class="sd">   every character of `delimiter` is a potential split point.</span>

<span class="sd">  For example:</span>
<span class="sd">    N = 2, input[0] is &#39;hello world&#39; and input[1] is &#39;a b c&#39;, then the output</span>
<span class="sd">    will be</span>

<span class="sd">    indices = [0, 0;</span>
<span class="sd">               0, 1;</span>
<span class="sd">               1, 0;</span>
<span class="sd">               1, 1;</span>
<span class="sd">               1, 2]</span>
<span class="sd">    shape = [2, 3]</span>
<span class="sd">    values = [&#39;hello&#39;, &#39;world&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. 1-D. Strings to split.</span>
<span class="sd">    delimiter: A `Tensor` of type `string`.</span>
<span class="sd">      0-D. Delimiter characters (bytes), or empty string.</span>
<span class="sd">    skip_empty: An optional `bool`. Defaults to `True`.</span>
<span class="sd">      A `bool`. If `True`, skip the empty strings from the result.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A tuple of `Tensor` objects (indices, values, shape).</span>

<span class="sd">    indices: A `Tensor` of type `int64`.</span>
<span class="sd">    values: A `Tensor` of type `string`.</span>
<span class="sd">    shape: A `Tensor` of type `int64`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringSplit&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="s2">&quot;skip_empty&quot;</span><span class="p">,</span> <span class="n">skip_empty</span><span class="p">)</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringSplitOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_split_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">skip_empty</span><span class="o">=</span><span class="n">skip_empty</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">skip_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">skip_empty</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="n">skip_empty</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">skip_empty</span><span class="p">,</span> <span class="s2">&quot;skip_empty&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringSplit&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
                       <span class="n">skip_empty</span><span class="o">=</span><span class="n">skip_empty</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;skip_empty&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;skip_empty&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringSplit&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringSplitOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringSplit</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringSplit&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_split</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_split_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">skip_empty</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">skip_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">skip_empty</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="n">skip_empty</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">skip_empty</span><span class="p">,</span> <span class="s2">&quot;skip_empty&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">delimiter</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;skip_empty&quot;</span><span class="p">,</span> <span class="n">skip_empty</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringSplit&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringSplit&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringSplitOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">_StringSplitV2Output</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s2">&quot;StringSplitV2&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">,</span> <span class="s2">&quot;values&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">string_split_v2</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Split elements of `source` based on `sep` into a `SparseTensor`.</span>

<span class="sd">  Let N be the size of source (typically N will be the batch size). Split each</span>
<span class="sd">  element of `source` based on `sep` and return a `SparseTensor`</span>
<span class="sd">  containing the split tokens. Empty tokens are ignored.</span>

<span class="sd">  For example, N = 2, source[0] is &#39;hello world&#39; and source[1] is &#39;a b c&#39;,</span>
<span class="sd">  then the output will be</span>
<span class="sd">  ```</span>
<span class="sd">  st.indices = [0, 0;</span>
<span class="sd">                0, 1;</span>
<span class="sd">                1, 0;</span>
<span class="sd">                1, 1;</span>
<span class="sd">                1, 2]</span>
<span class="sd">  st.shape = [2, 3]</span>
<span class="sd">  st.values = [&#39;hello&#39;, &#39;world&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="sd">  ```</span>

<span class="sd">  If `sep` is given, consecutive delimiters are not grouped together and are</span>
<span class="sd">  deemed to delimit empty strings. For example, source of `&quot;1&lt;&gt;2&lt;&gt;&lt;&gt;3&quot;` and</span>
<span class="sd">  sep of `&quot;&lt;&gt;&quot;` returns `[&quot;1&quot;, &quot;2&quot;, &quot;&quot;, &quot;3&quot;]`. If `sep` is None or an empty</span>
<span class="sd">  string, consecutive whitespace are regarded as a single separator, and the</span>
<span class="sd">  result will contain no empty strings at the startor end if the string has</span>
<span class="sd">  leading or trailing whitespace.</span>

<span class="sd">  Note that the above mentioned behavior matches python&#39;s str.split.</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">      `1-D` string `Tensor`, the strings to split.</span>
<span class="sd">    sep: A `Tensor` of type `string`.</span>
<span class="sd">      `0-D` string `Tensor`, the delimiter character.</span>
<span class="sd">    maxsplit: An optional `int`. Defaults to `-1`.</span>
<span class="sd">      An `int`. If `maxsplit &gt; 0`, limit of the split of the result.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A tuple of `Tensor` objects (indices, values, shape).</span>

<span class="sd">    indices: A `Tensor` of type `int64`.</span>
<span class="sd">    values: A `Tensor` of type `string`.</span>
<span class="sd">    shape: A `Tensor` of type `int64`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringSplitV2&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;maxsplit&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="p">)</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringSplitV2Output</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_split_v2_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="n">maxsplit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">maxsplit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">maxsplit</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="n">maxsplit</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">maxsplit</span><span class="p">,</span> <span class="s2">&quot;maxsplit&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringSplitV2&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="n">maxsplit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;maxsplit&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;maxsplit&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringSplitV2&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringSplitV2Output</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringSplitV2</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringSplitV2&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_split_v2</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_split_v2_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">maxsplit</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">maxsplit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">maxsplit</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="n">maxsplit</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">maxsplit</span><span class="p">,</span> <span class="s2">&quot;maxsplit&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">sep</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">,</span> <span class="n">sep</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;maxsplit&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringSplitV2&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringSplitV2&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_StringSplitV2Output</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.strip&#39;</span><span class="p">,</span> <span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;strings.strip&#39;</span><span class="p">,</span> <span class="s1">&#39;string_strip&#39;</span><span class="p">])</span>
<span class="nd">@deprecated_endpoints</span><span class="p">(</span><span class="s1">&#39;string_strip&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">string_strip</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Strip leading and trailing whitespaces from the Tensor.</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. A string `Tensor` of any shape.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringStrip&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_strip_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">string_strip</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringStrip&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">string_strip</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringStrip&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringStrip</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringStrip&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_strip</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_strip_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringStrip&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringStrip&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">string_to_hash_bucket</span><span class="p">(</span><span class="n">string_tensor</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Converts each string in the input Tensor to its hash mod by a number of buckets.</span>

<span class="sd">  The hash function is deterministic on the content of the string within the</span>
<span class="sd">  process.</span>

<span class="sd">  Note that the hash function may change from time to time.</span>
<span class="sd">  This functionality will be deprecated and it&#39;s recommended to use</span>
<span class="sd">  `tf.string_to_hash_bucket_fast()` or `tf.string_to_hash_bucket_strong()`.</span>

<span class="sd">  Args:</span>
<span class="sd">    string_tensor: A `Tensor` of type `string`.</span>
<span class="sd">    num_buckets: An `int` that is `&gt;= 1`. The number of buckets.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `int64`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringToHashBucket&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="n">string_tensor</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_to_hash_bucket_eager_fallback</span><span class="p">(</span>
            <span class="n">string_tensor</span><span class="p">,</span> <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">num_buckets</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucket&quot;</span><span class="p">,</span> <span class="n">string_tensor</span><span class="o">=</span><span class="n">string_tensor</span><span class="p">,</span>
                              <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucket&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringToHashBucket</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringToHashBucket&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_to_hash_bucket</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_to_hash_bucket_eager_fallback</span><span class="p">(</span><span class="n">string_tensor</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">num_buckets</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">)</span>
  <span class="n">string_tensor</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">string_tensor</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="n">string_tensor</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringToHashBucket&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucket&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.to_hash_bucket_fast&#39;</span><span class="p">,</span> <span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;strings.to_hash_bucket_fast&#39;</span><span class="p">,</span> <span class="s1">&#39;string_to_hash_bucket_fast&#39;</span><span class="p">])</span>
<span class="nd">@deprecated_endpoints</span><span class="p">(</span><span class="s1">&#39;string_to_hash_bucket_fast&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">string_to_hash_bucket_fast</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Converts each string in the input Tensor to its hash mod by a number of buckets.</span>

<span class="sd">  The hash function is deterministic on the content of the string within the</span>
<span class="sd">  process and will never change. However, it is not suitable for cryptography.</span>
<span class="sd">  This function may be used when CPU time is scarce and inputs are trusted or</span>
<span class="sd">  unimportant. There is a risk of adversaries constructing inputs that all hash</span>
<span class="sd">  to the same bucket. To prevent this problem, use a strong hash function with</span>
<span class="sd">  `tf.string_to_hash_bucket_strong`.</span>

<span class="sd">  Examples:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.to_hash_bucket_fast([&quot;Hello&quot;, &quot;TensorFlow&quot;, &quot;2.x&quot;], 3).numpy()</span>
<span class="sd">  array([0, 2, 2])</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. The strings to assign a hash bucket.</span>
<span class="sd">    num_buckets: An `int` that is `&gt;= 1`. The number of buckets.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `int64`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringToHashBucketFast&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_to_hash_bucket_fast_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">string_to_hash_bucket_fast</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span>
                                          <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">num_buckets</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucketFast&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span>
                                  <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">string_to_hash_bucket_fast</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span>
                                      <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucketFast&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringToHashBucketFast</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringToHashBucketFast&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_to_hash_bucket_fast</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_to_hash_bucket_fast_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">num_buckets</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringToHashBucketFast&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
                             <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucketFast&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.to_hash_bucket_strong&#39;</span><span class="p">,</span> <span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;strings.to_hash_bucket_strong&#39;</span><span class="p">,</span> <span class="s1">&#39;string_to_hash_bucket_strong&#39;</span><span class="p">])</span>
<span class="nd">@deprecated_endpoints</span><span class="p">(</span><span class="s1">&#39;string_to_hash_bucket_strong&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">string_to_hash_bucket_strong</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Converts each string in the input Tensor to its hash mod by a number of buckets.</span>

<span class="sd">  The hash function is deterministic on the content of the string within the</span>
<span class="sd">  process. The hash function is a keyed hash function, where attribute `key`</span>
<span class="sd">  defines the key of the hash function. `key` is an array of 2 elements.</span>

<span class="sd">  A strong hash is important when inputs may be malicious, e.g. URLs with</span>
<span class="sd">  additional components. Adversaries could try to make their inputs hash to the</span>
<span class="sd">  same bucket for a denial-of-service attack or to skew the results. A strong</span>
<span class="sd">  hash can be used to make it difficult to find inputs with a skewed hash value</span>
<span class="sd">  distribution over buckets. This requires that the hash function is</span>
<span class="sd">  seeded by a high-entropy (random) &quot;key&quot; unknown to the adversary.</span>

<span class="sd">  The additional robustness comes at a cost of roughly 4x higher compute</span>
<span class="sd">  time than `tf.string_to_hash_bucket_fast`.</span>

<span class="sd">  Examples:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.to_hash_bucket_strong([&quot;Hello&quot;, &quot;TF&quot;], 3, [1, 2]).numpy()</span>
<span class="sd">  array([2, 0])</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. The strings to assign a hash bucket.</span>
<span class="sd">    num_buckets: An `int` that is `&gt;= 1`. The number of buckets.</span>
<span class="sd">    key: A list of `ints`.</span>
<span class="sd">      The key used to seed the hash function, passed as a list of two uint64</span>
<span class="sd">      elements.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `int64`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringToHashBucketStrong&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_to_hash_bucket_strong_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">string_to_hash_bucket_strong</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span>
                                            <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">num_buckets</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
        <span class="s2">&quot;Expected list for &#39;key&#39; argument to &quot;</span>
        <span class="s2">&quot;&#39;string_to_hash_bucket_strong&#39; Op, not </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
  <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">_i</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucketStrong&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span>
                                    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">string_to_hash_bucket_strong</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="o">=</span><span class="n">num_buckets</span><span class="p">,</span>
                                        <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">),</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucketStrong&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringToHashBucketStrong</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringToHashBucketStrong&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_to_hash_bucket_strong</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_to_hash_bucket_strong_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">num_buckets</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;num_buckets&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
        <span class="s2">&quot;Expected list for &#39;key&#39; argument to &quot;</span>
        <span class="s2">&quot;&#39;string_to_hash_bucket_strong&#39; Op, not </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
  <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">_i</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;num_buckets&quot;</span><span class="p">,</span> <span class="n">num_buckets</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringToHashBucketStrong&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
                             <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringToHashBucketStrong&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.upper&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">string_upper</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Converts all lowercase characters into their respective uppercase replacements.</span>

<span class="sd">  Example:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.upper(&quot;CamelCase string and ALL CAPS&quot;)</span>
<span class="sd">  &lt;tf.Tensor: shape=(), dtype=string, numpy=b&#39;CAMELCASE STRING AND ALL CAPS&#39;&gt;</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">    encoding: An optional `string`. Defaults to `&quot;&quot;`.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;StringUpper&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_upper_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">string_upper</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;StringUpper&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">string_upper</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringUpper&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">StringUpper</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.StringUpper&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">string_upper</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">string_upper_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoding</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="s2">&quot;encoding&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;StringUpper&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;StringUpper&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">substr</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;BYTE&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return substrings from `Tensor` of strings.</span>

<span class="sd">  For each string in the input `Tensor`, creates a substring starting at index</span>
<span class="sd">  `pos` with a total length of `len`.</span>

<span class="sd">  If `len` defines a substring that would extend beyond the length of the input</span>
<span class="sd">  string, or if `len` is negative, then as many characters as possible are used.</span>

<span class="sd">  A negative `pos` indicates distance within the string backwards from the end.</span>

<span class="sd">  If `pos` specifies an index which is out of range for any of the input strings,</span>
<span class="sd">  then an `InvalidArgumentError` is thrown.</span>

<span class="sd">  `pos` and `len` must have the same shape, otherwise a `ValueError` is thrown on</span>
<span class="sd">  Op creation.</span>

<span class="sd">  *NOTE*: `Substr` supports broadcasting up to two dimensions. More about</span>
<span class="sd">  broadcasting</span>
<span class="sd">  [here](http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html)</span>

<span class="sd">  ---</span>

<span class="sd">  Examples</span>

<span class="sd">  Using scalar `pos` and `len`:</span>

<span class="sd">  ```python</span>
<span class="sd">  input = [b&#39;Hello&#39;, b&#39;World&#39;]</span>
<span class="sd">  position = 1</span>
<span class="sd">  length = 3</span>

<span class="sd">  output = [b&#39;ell&#39;, b&#39;orl&#39;]</span>
<span class="sd">  ```</span>

<span class="sd">  Using `pos` and `len` with same shape as `input`:</span>

<span class="sd">  ```python</span>
<span class="sd">  input = [[b&#39;ten&#39;, b&#39;eleven&#39;, b&#39;twelve&#39;],</span>
<span class="sd">           [b&#39;thirteen&#39;, b&#39;fourteen&#39;, b&#39;fifteen&#39;],</span>
<span class="sd">           [b&#39;sixteen&#39;, b&#39;seventeen&#39;, b&#39;eighteen&#39;]]</span>
<span class="sd">  position = [[1, 2, 3],</span>
<span class="sd">              [1, 2, 3],</span>
<span class="sd">              [1, 2, 3]]</span>
<span class="sd">  length =   [[2, 3, 4],</span>
<span class="sd">              [4, 3, 2],</span>
<span class="sd">              [5, 5, 5]]</span>

<span class="sd">  output = [[b&#39;en&#39;, b&#39;eve&#39;, b&#39;lve&#39;],</span>
<span class="sd">            [b&#39;hirt&#39;, b&#39;urt&#39;, b&#39;te&#39;],</span>
<span class="sd">            [b&#39;ixtee&#39;, b&#39;vente&#39;, b&#39;hteen&#39;]]</span>
<span class="sd">  ```</span>

<span class="sd">  Broadcasting `pos` and `len` onto `input`:</span>

<span class="sd">  ```</span>
<span class="sd">  input = [[b&#39;ten&#39;, b&#39;eleven&#39;, b&#39;twelve&#39;],</span>
<span class="sd">           [b&#39;thirteen&#39;, b&#39;fourteen&#39;, b&#39;fifteen&#39;],</span>
<span class="sd">           [b&#39;sixteen&#39;, b&#39;seventeen&#39;, b&#39;eighteen&#39;],</span>
<span class="sd">           [b&#39;nineteen&#39;, b&#39;twenty&#39;, b&#39;twentyone&#39;]]</span>
<span class="sd">  position = [1, 2, 3]</span>
<span class="sd">  length =   [1, 2, 3]</span>

<span class="sd">  output = [[b&#39;e&#39;, b&#39;ev&#39;, b&#39;lve&#39;],</span>
<span class="sd">            [b&#39;h&#39;, b&#39;ur&#39;, b&#39;tee&#39;],</span>
<span class="sd">            [b&#39;i&#39;, b&#39;ve&#39;, b&#39;hte&#39;],</span>
<span class="sd">            [b&#39;i&#39;, b&#39;en&#39;, b&#39;nty&#39;]]</span>
<span class="sd">  ```</span>

<span class="sd">  Broadcasting `input` onto `pos` and `len`:</span>

<span class="sd">  ```</span>
<span class="sd">  input = b&#39;thirteen&#39;</span>
<span class="sd">  position = [1, 5, 7]</span>
<span class="sd">  length =   [3, 2, 1]</span>

<span class="sd">  output = [b&#39;hir&#39;, b&#39;ee&#39;, b&#39;n&#39;]</span>
<span class="sd">  ```</span>

<span class="sd">  Raises:</span>

<span class="sd">    * `ValueError`: If the first argument cannot be converted to a</span>
<span class="sd">       Tensor of `dtype string`.</span>
<span class="sd">    * `InvalidArgumentError`: If indicies are out of range.</span>
<span class="sd">    * `ValueError`: If `pos` and `len` are not the same shape.</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`. Tensor of strings</span>
<span class="sd">    pos: A `Tensor`. Must be one of the following types: `int32`, `int64`.</span>
<span class="sd">      Scalar defining the position of first character in each substring</span>
<span class="sd">    len: A `Tensor`. Must have the same type as `pos`.</span>
<span class="sd">      Scalar defining the number of characters to include in each substring</span>
<span class="sd">    unit: An optional `string` from: `&quot;BYTE&quot;, &quot;UTF8_CHAR&quot;`. Defaults to `&quot;BYTE&quot;`.</span>
<span class="sd">      The unit that is used to create the substring.  One of: `&quot;BYTE&quot;` (for</span>
<span class="sd">      defining position and length by bytes) or `&quot;UTF8_CHAR&quot;` (for the UTF-8</span>
<span class="sd">      encoded Unicode code points).  The default is `&quot;BYTE&quot;`. Results are undefined if</span>
<span class="sd">      `unit=UTF8_CHAR` and the `input` strings do not contain structurally valid</span>
<span class="sd">      UTF-8.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;Substr&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">substr_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;BYTE&quot;</span>
  <span class="n">unit</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;Substr&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">),</span> <span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;Substr&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">Substr</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.Substr&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">substr</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">substr_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;BYTE&quot;</span>
  <span class="n">unit</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">)</span>
  <span class="n">_attr_T</span><span class="p">,</span> <span class="n">_inputs_T</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">args_to_matching_eager</span><span class="p">([</span><span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="p">],</span> <span class="n">ctx</span><span class="p">)</span>
  <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="p">)</span> <span class="o">=</span> <span class="n">_inputs_T</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">len</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">_attr_T</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Substr&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span>
                             <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;Substr&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">_UnicodeDecodeOutput</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s2">&quot;UnicodeDecode&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;row_splits&quot;</span><span class="p">,</span> <span class="s2">&quot;char_values&quot;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">unicode_decode</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="o">=</span><span class="mi">65533</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Tsplits</span><span class="o">=</span><span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Decodes each string in `input` into a sequence of Unicode code points.</span>

<span class="sd">  The character codepoints for all strings are returned using a single vector</span>
<span class="sd">  `char_values`, with strings expanded to characters in row-major order.</span>

<span class="sd">  The `row_splits` tensor indicates where the codepoints for</span>
<span class="sd">  each input string begin and end within the `char_values` tensor.</span>
<span class="sd">  In particular, the values for the `i`th</span>
<span class="sd">  string (in row-major order) are stored in the slice</span>
<span class="sd">  `[row_splits[i]:row_splits[i+1]]`. Thus:</span>

<span class="sd">  * `char_values[row_splits[i]+j]` is the Unicode codepoint for the `j`th</span>
<span class="sd">    character in the `i`th string (in row-major order).</span>
<span class="sd">  * `row_splits[i+1] - row_splits[i]` is the number of characters in the `i`th</span>
<span class="sd">    string (in row-major order).</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">      The text to be decoded. Can have any shape. Note that the output is flattened</span>
<span class="sd">      to a vector of char values.</span>
<span class="sd">    input_encoding: A `string`.</span>
<span class="sd">      Text encoding of the input strings. This is any of the encodings supported</span>
<span class="sd">      by ICU ucnv algorithmic converters. Examples: `&quot;UTF-16&quot;, &quot;US ASCII&quot;, &quot;UTF-8&quot;`.</span>
<span class="sd">    errors: An optional `string` from: `&quot;strict&quot;, &quot;replace&quot;, &quot;ignore&quot;`. Defaults to `&quot;replace&quot;`.</span>
<span class="sd">      Error handling policy when there is invalid formatting found in the input.</span>
<span class="sd">      The value of &#39;strict&#39; will cause the operation to produce a InvalidArgument</span>
<span class="sd">      error on any invalid input formatting. A value of &#39;replace&#39; (the default) will</span>
<span class="sd">      cause the operation to replace any invalid formatting in the input with the</span>
<span class="sd">      `replacement_char` codepoint. A value of &#39;ignore&#39; will cause the operation to</span>
<span class="sd">      skip any invalid formatting in the input and produce no corresponding output</span>
<span class="sd">      character.</span>
<span class="sd">    replacement_char: An optional `int`. Defaults to `65533`.</span>
<span class="sd">      The replacement character codepoint to be used in place of any invalid</span>
<span class="sd">      formatting in the input when `errors=&#39;replace&#39;`. Any valid unicode codepoint may</span>
<span class="sd">      be used. The default value is the default unicode replacement character is</span>
<span class="sd">      0xFFFD or U+65533.)</span>
<span class="sd">    replace_control_characters: An optional `bool`. Defaults to `False`.</span>
<span class="sd">      Whether to replace the C0 control characters (00-1F) with the</span>
<span class="sd">      `replacement_char`. Default is false.</span>
<span class="sd">    Tsplits: An optional `tf.DType` from: `tf.int32, tf.int64`. Defaults to `tf.int64`.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A tuple of `Tensor` objects (row_splits, char_values).</span>

<span class="sd">    row_splits: A `Tensor` of type `Tsplits`.</span>
<span class="sd">    char_values: A `Tensor` of type `int32`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;UnicodeDecode&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span>
        <span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span>
        <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span>
        <span class="n">Tsplits</span><span class="p">)</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">_UnicodeDecodeOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unicode_decode_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
            <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span>
            <span class="n">Tsplits</span><span class="o">=</span><span class="n">Tsplits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">input_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_control_characters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">Tsplits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span>
  <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_type</span><span class="p">(</span><span class="n">Tsplits</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeDecode&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span>
                         <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span> <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
                         <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span>
                         <span class="n">Tsplits</span><span class="o">=</span><span class="n">Tsplits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">),</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">),</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;replacement_char&quot;</span><span class="p">),</span>
              <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;replace_control_characters&quot;</span><span class="p">),</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;Tsplits&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeDecode&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_UnicodeDecodeOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">UnicodeDecode</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.UnicodeDecode&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">unicode_decode</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">unicode_decode_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="p">,</span> <span class="n">Tsplits</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">input_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_control_characters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">Tsplits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span>
  <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_type</span><span class="p">(</span><span class="n">Tsplits</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span>
  <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span>
  <span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span> <span class="n">Tsplits</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;UnicodeDecode&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeDecode&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_UnicodeDecodeOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">_UnicodeDecodeWithOffsetsOutput</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s2">&quot;UnicodeDecodeWithOffsets&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;row_splits&quot;</span><span class="p">,</span> <span class="s2">&quot;char_values&quot;</span><span class="p">,</span> <span class="s2">&quot;char_to_byte_starts&quot;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">unicode_decode_with_offsets</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="o">=</span><span class="mi">65533</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Tsplits</span><span class="o">=</span><span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Decodes each string in `input` into a sequence of Unicode code points.</span>

<span class="sd">  The character codepoints for all strings are returned using a single vector</span>
<span class="sd">  `char_values`, with strings expanded to characters in row-major order.</span>
<span class="sd">  Similarly, the character start byte offsets are returned using a single vector</span>
<span class="sd">  `char_to_byte_starts`, with strings expanded in row-major order.</span>

<span class="sd">  The `row_splits` tensor indicates where the codepoints and start offsets for</span>
<span class="sd">  each input string begin and end within the `char_values` and</span>
<span class="sd">  `char_to_byte_starts` tensors.  In particular, the values for the `i`th</span>
<span class="sd">  string (in row-major order) are stored in the slice</span>
<span class="sd">  `[row_splits[i]:row_splits[i+1]]`. Thus:</span>

<span class="sd">  * `char_values[row_splits[i]+j]` is the Unicode codepoint for the `j`th</span>
<span class="sd">    character in the `i`th string (in row-major order).</span>
<span class="sd">  * `char_to_bytes_starts[row_splits[i]+j]` is the start byte offset for the `j`th</span>
<span class="sd">    character in the `i`th string (in row-major order).</span>
<span class="sd">  * `row_splits[i+1] - row_splits[i]` is the number of characters in the `i`th</span>
<span class="sd">    string (in row-major order).</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">      The text to be decoded. Can have any shape. Note that the output is flattened</span>
<span class="sd">      to a vector of char values.</span>
<span class="sd">    input_encoding: A `string`.</span>
<span class="sd">      Text encoding of the input strings. This is any of the encodings supported</span>
<span class="sd">      by ICU ucnv algorithmic converters. Examples: `&quot;UTF-16&quot;, &quot;US ASCII&quot;, &quot;UTF-8&quot;`.</span>
<span class="sd">    errors: An optional `string` from: `&quot;strict&quot;, &quot;replace&quot;, &quot;ignore&quot;`. Defaults to `&quot;replace&quot;`.</span>
<span class="sd">      Error handling policy when there is invalid formatting found in the input.</span>
<span class="sd">      The value of &#39;strict&#39; will cause the operation to produce a InvalidArgument</span>
<span class="sd">      error on any invalid input formatting. A value of &#39;replace&#39; (the default) will</span>
<span class="sd">      cause the operation to replace any invalid formatting in the input with the</span>
<span class="sd">      `replacement_char` codepoint. A value of &#39;ignore&#39; will cause the operation to</span>
<span class="sd">      skip any invalid formatting in the input and produce no corresponding output</span>
<span class="sd">      character.</span>
<span class="sd">    replacement_char: An optional `int`. Defaults to `65533`.</span>
<span class="sd">      The replacement character codepoint to be used in place of any invalid</span>
<span class="sd">      formatting in the input when `errors=&#39;replace&#39;`. Any valid unicode codepoint may</span>
<span class="sd">      be used. The default value is the default unicode replacement character is</span>
<span class="sd">      0xFFFD or U+65533.)</span>
<span class="sd">    replace_control_characters: An optional `bool`. Defaults to `False`.</span>
<span class="sd">      Whether to replace the C0 control characters (00-1F) with the</span>
<span class="sd">      `replacement_char`. Default is false.</span>
<span class="sd">    Tsplits: An optional `tf.DType` from: `tf.int32, tf.int64`. Defaults to `tf.int64`.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A tuple of `Tensor` objects (row_splits, char_values, char_to_byte_starts).</span>

<span class="sd">    row_splits: A `Tensor` of type `Tsplits`.</span>
<span class="sd">    char_values: A `Tensor` of type `int32`.</span>
<span class="sd">    char_to_byte_starts: A `Tensor` of type `int64`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;UnicodeDecodeWithOffsets&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span>
        <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span>
        <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span>
        <span class="n">Tsplits</span><span class="p">)</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">_UnicodeDecodeWithOffsetsOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unicode_decode_with_offsets_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
            <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span>
            <span class="n">Tsplits</span><span class="o">=</span><span class="n">Tsplits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">input_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_control_characters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">Tsplits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span>
  <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_type</span><span class="p">(</span><span class="n">Tsplits</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeDecodeWithOffsets&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span>
                                    <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span>
                                    <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
                                    <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
                                    <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span>
                                    <span class="n">Tsplits</span><span class="o">=</span><span class="n">Tsplits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">),</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">),</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;replacement_char&quot;</span><span class="p">),</span>
              <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;replace_control_characters&quot;</span><span class="p">),</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;Tsplits&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeDecodeWithOffsets&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_UnicodeDecodeWithOffsetsOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">UnicodeDecodeWithOffsets</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.UnicodeDecodeWithOffsets&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">unicode_decode_with_offsets</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">unicode_decode_with_offsets_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="p">,</span> <span class="n">Tsplits</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">input_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_control_characters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">Tsplits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span>
  <span class="n">Tsplits</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_type</span><span class="p">(</span><span class="n">Tsplits</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span>
  <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span>
  <span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span> <span class="n">Tsplits</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;UnicodeDecodeWithOffsets&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                             <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
                             <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeDecodeWithOffsets&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_UnicodeDecodeWithOffsetsOutput</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">_result</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="k">def</span> <span class="nf">unicode_encode</span><span class="p">(</span><span class="n">input_values</span><span class="p">,</span> <span class="n">input_splits</span><span class="p">,</span> <span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="o">=</span><span class="mi">65533</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Encode a tensor of ints into unicode strings.</span>

<span class="sd">  Returns a vector of strings, where `output[i]` is constructed by encoding the</span>
<span class="sd">  Unicode codepoints in `input_values[input_splits[i]:input_splits[i+1]]`</span>
<span class="sd">  using `output_encoding`.</span>

<span class="sd">  ---</span>

<span class="sd">  Example:</span>

<span class="sd">  ```</span>
<span class="sd">  input_values = [72, 101, 108, 108, 111, 87, 111, 114, 108, 100]</span>
<span class="sd">  input_splits = [0, 5, 10]</span>
<span class="sd">  output_encoding = &#39;UTF-8&#39;</span>

<span class="sd">  output = [&#39;Hello&#39;, &#39;World&#39;]</span>
<span class="sd">  ```</span>

<span class="sd">  Args:</span>
<span class="sd">    input_values: A `Tensor` of type `int32`.</span>
<span class="sd">      A 1D tensor containing the unicode codepoints that should be encoded.</span>
<span class="sd">    input_splits: A `Tensor`. Must be one of the following types: `int32`, `int64`.</span>
<span class="sd">      A 1D tensor specifying how the unicode codepoints should be split into strings.</span>
<span class="sd">      In particular, `output[i]` is constructed by encoding the codepoints in the</span>
<span class="sd">      slice `input_values[input_splits[i]:input_splits[i+1]]`.</span>
<span class="sd">    output_encoding: A `string` from: `&quot;UTF-8&quot;, &quot;UTF-16-BE&quot;, &quot;UTF-32-BE&quot;`.</span>
<span class="sd">      Unicode encoding of the output strings. Valid encodings are: `&quot;UTF-8&quot;,</span>
<span class="sd">      &quot;UTF-16-BE&quot;, and &quot;UTF-32-BE&quot;`.</span>
<span class="sd">    errors: An optional `string` from: `&quot;ignore&quot;, &quot;replace&quot;, &quot;strict&quot;`. Defaults to `&quot;replace&quot;`.</span>
<span class="sd">      Error handling policy when there is invalid formatting found in the input.</span>
<span class="sd">      The value of &#39;strict&#39; will cause the operation to produce a InvalidArgument</span>
<span class="sd">      error on any invalid input formatting. A value of &#39;replace&#39; (the default) will</span>
<span class="sd">      cause the operation to replace any invalid formatting in the input with the</span>
<span class="sd">      `replacement_char` codepoint. A value of &#39;ignore&#39; will cause the operation to</span>
<span class="sd">      skip any invalid formatting in the input and produce no corresponding output</span>
<span class="sd">      character.</span>
<span class="sd">    replacement_char: An optional `int`. Defaults to `65533`.</span>
<span class="sd">      The replacement character codepoint to be used in place of any invalid</span>
<span class="sd">      formatting in the input when `errors=&#39;replace&#39;`. Any valid unicode codepoint may</span>
<span class="sd">      be used. The default value is the default unicode replacement character is</span>
<span class="sd">      0xFFFD (U+65533).</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;UnicodeEncode&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="n">input_values</span><span class="p">,</span> <span class="n">input_splits</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span>
        <span class="s2">&quot;output_encoding&quot;</span><span class="p">,</span> <span class="n">output_encoding</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span>
        <span class="n">replacement_char</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unicode_encode_eager_fallback</span><span class="p">(</span>
            <span class="n">input_values</span><span class="p">,</span> <span class="n">input_splits</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">output_encoding</span><span class="o">=</span><span class="n">output_encoding</span><span class="p">,</span>
            <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">output_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">output_encoding</span><span class="p">,</span> <span class="s2">&quot;output_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeEncode&quot;</span><span class="p">,</span> <span class="n">input_values</span><span class="o">=</span><span class="n">input_values</span><span class="p">,</span> <span class="n">input_splits</span><span class="o">=</span><span class="n">input_splits</span><span class="p">,</span>
                         <span class="n">output_encoding</span><span class="o">=</span><span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
                         <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">),</span> <span class="s2">&quot;output_encoding&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;output_encoding&quot;</span><span class="p">),</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;replacement_char&quot;</span><span class="p">),</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;Tsplits&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeEncode&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">UnicodeEncode</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.UnicodeEncode&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">unicode_encode</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">unicode_encode_eager_fallback</span><span class="p">(</span><span class="n">input_values</span><span class="p">,</span> <span class="n">input_splits</span><span class="p">,</span> <span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">output_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">output_encoding</span><span class="p">,</span> <span class="s2">&quot;output_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="n">_attr_Tsplits</span><span class="p">,</span> <span class="p">(</span><span class="n">input_splits</span><span class="p">,)</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">args_to_matching_eager</span><span class="p">([</span><span class="n">input_splits</span><span class="p">],</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
  <span class="n">input_values</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">input_values</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="n">input_values</span><span class="p">,</span> <span class="n">input_splits</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;output_encoding&quot;</span><span class="p">,</span> <span class="n">output_encoding</span><span class="p">,</span>
  <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;Tsplits&quot;</span><span class="p">,</span> <span class="n">_attr_Tsplits</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;UnicodeEncode&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeEncode&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.unicode_script&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">unicode_script</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine the script codes of a given tensor of Unicode integer code points.</span>

<span class="sd">  This operation converts Unicode code points to script codes corresponding to</span>
<span class="sd">  each code point. Script codes correspond to International Components for</span>
<span class="sd">  Unicode (ICU) UScriptCode values. See http://icu-project.org/apiref/icu4c/uscript_8h.html.</span>
<span class="sd">  Returns -1 (USCRIPT_INVALID_CODE) for invalid codepoints. Output shape will</span>
<span class="sd">  match input shape.</span>

<span class="sd">  Examples:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.unicode_script([1, 31, 38])</span>
<span class="sd">  &lt;tf.Tensor: shape=(3,), dtype=int32, numpy=array([0, 0, 0], dtype=int32)&gt;</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `int32`. A Tensor of int32 Unicode code points.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `int32`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;UnicodeScript&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unicode_script_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">unicode_script</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeScript&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">unicode_script</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeScript&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">UnicodeScript</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.UnicodeScript&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">unicode_script</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">unicode_script_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;UnicodeScript&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeScript&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.unicode_transcode&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">unicode_transcode</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="o">=</span><span class="mi">65533</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Transcode the input text from a source encoding to a destination encoding.</span>

<span class="sd">  The input is a string tensor of any shape. The output is a string tensor of</span>
<span class="sd">  the same shape containing the transcoded strings. Output strings are always</span>
<span class="sd">  valid unicode. If the input contains invalid encoding positions, the</span>
<span class="sd">  `errors` attribute sets the policy for how to deal with them. If the default</span>
<span class="sd">  error-handling policy is used, invalid formatting will be substituted in the</span>
<span class="sd">  output by the `replacement_char`. If the errors policy is to `ignore`, any</span>
<span class="sd">  invalid encoding positions in the input are skipped and not included in the</span>
<span class="sd">  output. If it set to `strict` then any invalid formatting will result in an</span>
<span class="sd">  InvalidArgument error.</span>

<span class="sd">  This operation can be used with `output_encoding = input_encoding` to enforce</span>
<span class="sd">  correct formatting for inputs even if they are already in the desired encoding.</span>

<span class="sd">  If the input is prefixed by a Byte Order Mark needed to determine encoding</span>
<span class="sd">  (e.g. if the encoding is UTF-16 and the BOM indicates big-endian), then that</span>
<span class="sd">  BOM will be consumed and not emitted into the output. If the input encoding</span>
<span class="sd">  is marked with an explicit endianness (e.g. UTF-16-BE), then the BOM is</span>
<span class="sd">  interpreted as a non-breaking-space and is preserved in the output (including</span>
<span class="sd">  always for UTF-8).</span>

<span class="sd">  The end result is that if the input is marked as an explicit endianness the</span>
<span class="sd">  transcoding is faithful to all codepoints in the source. If it is not marked</span>
<span class="sd">  with an explicit endianness, the BOM is not considered part of the string itself</span>
<span class="sd">  but as metadata, and so is not preserved in the output.</span>

<span class="sd">  Examples:</span>

<span class="sd">  &gt;&gt;&gt; tf.strings.unicode_transcode([&quot;Hello&quot;, &quot;TensorFlow&quot;, &quot;2.x&quot;], &quot;UTF-8&quot;, &quot;UTF-16-BE&quot;)</span>
<span class="sd">  &lt;tf.Tensor: shape=(3,), dtype=string, numpy=</span>
<span class="sd">  array([b&#39;\x00H\x00e\x00l\x00l\x00o&#39;,</span>
<span class="sd">         b&#39;\x00T\x00e\x00n\x00s\x00o\x00r\x00F\x00l\x00o\x00w&#39;,</span>
<span class="sd">         b&#39;\x002\x00.\x00x&#39;], dtype=object)&gt;</span>
<span class="sd">  &gt;&gt;&gt; tf.strings.unicode_transcode([&quot;A&quot;, &quot;B&quot;, &quot;C&quot;], &quot;US ASCII&quot;, &quot;UTF-8&quot;).numpy()</span>
<span class="sd">  array([b&#39;A&#39;, b&#39;B&#39;, b&#39;C&#39;], dtype=object)</span>

<span class="sd">  Args:</span>
<span class="sd">    input: A `Tensor` of type `string`.</span>
<span class="sd">      The text to be processed. Can have any shape.</span>
<span class="sd">    input_encoding: A `string`.</span>
<span class="sd">      Text encoding of the input strings. This is any of the encodings supported</span>
<span class="sd">      by ICU ucnv algorithmic converters. Examples: `&quot;UTF-16&quot;, &quot;US ASCII&quot;, &quot;UTF-8&quot;`.</span>
<span class="sd">    output_encoding: A `string` from: `&quot;UTF-8&quot;, &quot;UTF-16-BE&quot;, &quot;UTF-32-BE&quot;`.</span>
<span class="sd">      The unicode encoding to use in the output. Must be one of</span>
<span class="sd">      `&quot;UTF-8&quot;, &quot;UTF-16-BE&quot;, &quot;UTF-32-BE&quot;`. Multi-byte encodings will be big-endian.</span>
<span class="sd">    errors: An optional `string` from: `&quot;strict&quot;, &quot;replace&quot;, &quot;ignore&quot;`. Defaults to `&quot;replace&quot;`.</span>
<span class="sd">      Error handling policy when there is invalid formatting found in the input.</span>
<span class="sd">      The value of &#39;strict&#39; will cause the operation to produce a InvalidArgument</span>
<span class="sd">      error on any invalid input formatting. A value of &#39;replace&#39; (the default) will</span>
<span class="sd">      cause the operation to replace any invalid formatting in the input with the</span>
<span class="sd">      `replacement_char` codepoint. A value of &#39;ignore&#39; will cause the operation to</span>
<span class="sd">      skip any invalid formatting in the input and produce no corresponding output</span>
<span class="sd">      character.</span>
<span class="sd">    replacement_char: An optional `int`. Defaults to `65533`.</span>
<span class="sd">      The replacement character codepoint to be used in place of any invalid</span>
<span class="sd">      formatting in the input when `errors=&#39;replace&#39;`. Any valid unicode codepoint may</span>
<span class="sd">      be used. The default value is the default unicode replacement character is</span>
<span class="sd">      0xFFFD or U+65533.)</span>

<span class="sd">      Note that for UTF-8, passing a replacement character expressible in 1 byte, such</span>
<span class="sd">      as &#39; &#39;, will preserve string alignment to the source since invalid bytes will be</span>
<span class="sd">      replaced with a 1-byte replacement. For UTF-16-BE and UTF-16-LE, any 1 or 2 byte</span>
<span class="sd">      replacement character will preserve byte alignment to the source.</span>
<span class="sd">    replace_control_characters: An optional `bool`. Defaults to `False`.</span>
<span class="sd">      Whether to replace the C0 control characters (00-1F) with the</span>
<span class="sd">      `replacement_char`. Default is false.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;UnicodeTranscode&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span>
        <span class="s2">&quot;output_encoding&quot;</span><span class="p">,</span> <span class="n">output_encoding</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span>
        <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span>
        <span class="n">replace_control_characters</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unicode_transcode_eager_fallback</span><span class="p">(</span>
            <span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span>
            <span class="n">output_encoding</span><span class="o">=</span><span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
            <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
            <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">unicode_transcode</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span>
                                 <span class="n">output_encoding</span><span class="o">=</span><span class="n">output_encoding</span><span class="p">,</span>
                                 <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
                                 <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
                                 <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span>
                                 <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="n">input_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">)</span>
  <span class="n">output_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">output_encoding</span><span class="p">,</span> <span class="s2">&quot;output_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_control_characters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeTranscode&quot;</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span>
                            <span class="n">output_encoding</span><span class="o">=</span><span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
                            <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
                            <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">unicode_transcode</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="n">input_encoding</span><span class="p">,</span>
                             <span class="n">output_encoding</span><span class="o">=</span><span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
                             <span class="n">replacement_char</span><span class="o">=</span><span class="n">replacement_char</span><span class="p">,</span>
                             <span class="n">replace_control_characters</span><span class="o">=</span><span class="n">replace_control_characters</span><span class="p">,</span>
                             <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">),</span>
              <span class="s2">&quot;output_encoding&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;output_encoding&quot;</span><span class="p">),</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">),</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_int</span><span class="p">(</span><span class="s2">&quot;replacement_char&quot;</span><span class="p">),</span>
              <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_bool</span><span class="p">(</span><span class="s2">&quot;replace_control_characters&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeTranscode&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">UnicodeTranscode</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.UnicodeTranscode&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">unicode_transcode</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">unicode_transcode_eager_fallback</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="n">output_encoding</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="n">input_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;input_encoding&quot;</span><span class="p">)</span>
  <span class="n">output_encoding</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">output_encoding</span><span class="p">,</span> <span class="s2">&quot;output_encoding&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="s2">&quot;replace&quot;</span>
  <span class="n">errors</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replacement_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replacement_char</span> <span class="o">=</span> <span class="mi">65533</span>
  <span class="n">replacement_char</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_int</span><span class="p">(</span><span class="n">replacement_char</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">replace_control_characters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">replace_control_characters</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_bool</span><span class="p">(</span><span class="n">replace_control_characters</span><span class="p">,</span> <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">)</span>
  <span class="nb">input</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">input</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;input_encoding&quot;</span><span class="p">,</span> <span class="n">input_encoding</span><span class="p">,</span> <span class="s2">&quot;output_encoding&quot;</span><span class="p">,</span>
  <span class="n">output_encoding</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="s2">&quot;replacement_char&quot;</span><span class="p">,</span> <span class="n">replacement_char</span><span class="p">,</span>
  <span class="s2">&quot;replace_control_characters&quot;</span><span class="p">,</span> <span class="n">replace_control_characters</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;UnicodeTranscode&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnicodeTranscode&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>


<span class="nd">@_dispatch</span><span class="o">.</span><span class="n">add_dispatch_list</span>
<span class="nd">@tf_export</span><span class="p">(</span><span class="s1">&#39;strings.unsorted_segment_join&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">unsorted_segment_join</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Joins the elements of `inputs` based on `segment_ids`.</span>

<span class="sd">  Computes the string join along segments of a tensor.</span>
<span class="sd">  Given `segment_ids` with rank `N` and `data` with rank `N+M`:</span>

<span class="sd">      `output[i, k1...kM] = strings.join([data[j1...jN, k1...kM])`</span>

<span class="sd">  where the join is over all [j1...jN] such that segment_ids[j1...jN] = i.</span>
<span class="sd">  Strings are joined in row-major order.</span>

<span class="sd">  For example:</span>

<span class="sd">  ```python</span>
<span class="sd">  inputs = [[&#39;Y&#39;, &#39;q&#39;, &#39;c&#39;], [&#39;Y&#39;, &#39;6&#39;, &#39;6&#39;], [&#39;p&#39;, &#39;G&#39;, &#39;a&#39;]]</span>
<span class="sd">  output_array = string_ops.unsorted_segment_join(inputs=inputs,</span>
<span class="sd">                                                  segment_ids=[1, 0, 1],</span>
<span class="sd">                                                  num_segments=2,</span>
<span class="sd">                                                  separator=&#39;:&#39;))</span>
<span class="sd">  # output_array ==&gt; [[&#39;Y&#39;, &#39;6&#39;, &#39;6&#39;], [&#39;Y:p&#39;, &#39;q:G&#39;, &#39;c:a&#39;]]</span>


<span class="sd">  inputs = [&#39;this&#39;, &#39;is&#39;, &#39;a&#39;, &#39;test&#39;]</span>
<span class="sd">  output_array = string_ops.unsorted_segment_join(inputs=inputs,</span>
<span class="sd">                                                  segment_ids=[0, 0, 0, 0],</span>
<span class="sd">                                                  num_segments=1,</span>
<span class="sd">                                                  separator=&#39;:&#39;))</span>
<span class="sd">  # output_array ==&gt; [&#39;this:is:a:test&#39;]</span>
<span class="sd">  ```</span>

<span class="sd">  Args:</span>
<span class="sd">    inputs: A `Tensor` of type `string`. The input to be joined.</span>
<span class="sd">    segment_ids: A `Tensor`. Must be one of the following types: `int32`, `int64`.</span>
<span class="sd">      A tensor whose shape is a prefix of data.shape.  Negative segment ids are not</span>
<span class="sd">      supported.</span>
<span class="sd">    num_segments: A `Tensor`. Must be one of the following types: `int32`, `int64`.</span>
<span class="sd">      A scalar.</span>
<span class="sd">    separator: An optional `string`. Defaults to `&quot;&quot;`.</span>
<span class="sd">      The separator to use when joining.</span>
<span class="sd">    name: A name for the operation (optional).</span>

<span class="sd">  Returns:</span>
<span class="sd">    A `Tensor` of type `string`.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_ctx</span> <span class="o">=</span> <span class="n">_context</span><span class="o">.</span><span class="n">_context</span> <span class="ow">or</span> <span class="n">_context</span><span class="o">.</span><span class="n">context</span><span class="p">()</span>
  <span class="n">tld</span> <span class="o">=</span> <span class="n">_ctx</span><span class="o">.</span><span class="n">_thread_local_data</span>
  <span class="k">if</span> <span class="n">tld</span><span class="o">.</span><span class="n">is_eager</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">_result</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_FastPathExecute</span><span class="p">(</span>
        <span class="n">_ctx</span><span class="o">.</span><span class="n">_context_handle</span><span class="p">,</span> <span class="n">tld</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span> <span class="s2">&quot;UnsortedSegmentJoin&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tld</span><span class="o">.</span><span class="n">op_callbacks</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">,</span>
        <span class="n">separator</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">_result</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_FallbackException</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unsorted_segment_join_eager_fallback</span><span class="p">(</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">=</span><span class="n">_ctx</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_SymbolicException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Add nodes to the TensorFlow graph.</span>
      <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
              <span class="n">unsorted_segment_join</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="o">=</span><span class="n">segment_ids</span><span class="p">,</span>
                                     <span class="n">num_segments</span><span class="o">=</span><span class="n">num_segments</span><span class="p">,</span>
                                     <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">_core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">_ops</span><span class="o">.</span><span class="n">raise_from_not_ok_status</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="c1"># Add nodes to the TensorFlow graph.</span>
  <span class="k">if</span> <span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_op</span><span class="p">,</span> <span class="n">_outputs</span> <span class="o">=</span> <span class="n">_op_def_library</span><span class="o">.</span><span class="n">_apply_op_helper</span><span class="p">(</span>
        <span class="s2">&quot;UnsortedSegmentJoin&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="o">=</span><span class="n">segment_ids</span><span class="p">,</span>
                               <span class="n">num_segments</span><span class="o">=</span><span class="n">num_segments</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span>
                               <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span>
          <span class="n">unsorted_segment_join</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="o">=</span><span class="n">segment_ids</span><span class="p">,</span>
                                 <span class="n">num_segments</span><span class="o">=</span><span class="n">num_segments</span><span class="p">,</span>
                                 <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_dispatch</span><span class="o">.</span><span class="n">OpDispatcher</span><span class="o">.</span><span class="n">NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_outputs</span><span class="p">[:]</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">_op</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">),</span> <span class="s2">&quot;Tindices&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;Tindices&quot;</span><span class="p">),</span> <span class="s2">&quot;Tnumsegments&quot;</span><span class="p">,</span>
              <span class="n">_op</span><span class="o">.</span><span class="n">_get_attr_type</span><span class="p">(</span><span class="s2">&quot;Tnumsegments&quot;</span><span class="p">))</span>
    <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="n">_op</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnsortedSegmentJoin&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

<span class="n">UnsortedSegmentJoin</span> <span class="o">=</span> <span class="n">tf_export</span><span class="p">(</span><span class="s2">&quot;raw_ops.UnsortedSegmentJoin&quot;</span><span class="p">)(</span><span class="n">_ops</span><span class="o">.</span><span class="n">to_raw_op</span><span class="p">(</span><span class="n">unsorted_segment_join</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">unsorted_segment_join_eager_fallback</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">separator</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">make_str</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;separator&quot;</span><span class="p">)</span>
  <span class="n">_attr_Tindices</span><span class="p">,</span> <span class="p">(</span><span class="n">segment_ids</span><span class="p">,)</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">args_to_matching_eager</span><span class="p">([</span><span class="n">segment_ids</span><span class="p">],</span> <span class="n">ctx</span><span class="p">)</span>
  <span class="n">_attr_Tnumsegments</span><span class="p">,</span> <span class="p">(</span><span class="n">num_segments</span><span class="p">,)</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">args_to_matching_eager</span><span class="p">([</span><span class="n">num_segments</span><span class="p">],</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
  <span class="n">inputs</span> <span class="o">=</span> <span class="n">_ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">_dtypes</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
  <span class="n">_inputs_flat</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputs</span><span class="p">,</span> <span class="n">segment_ids</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">]</span>
  <span class="n">_attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="s2">&quot;Tindices&quot;</span><span class="p">,</span> <span class="n">_attr_Tindices</span><span class="p">,</span>
  <span class="s2">&quot;Tnumsegments&quot;</span><span class="p">,</span> <span class="n">_attr_Tnumsegments</span><span class="p">)</span>
  <span class="n">_result</span> <span class="o">=</span> <span class="n">_execute</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;UnsortedSegmentJoin&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">_inputs_flat</span><span class="p">,</span>
                             <span class="n">attrs</span><span class="o">=</span><span class="n">_attrs</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">_execute</span><span class="o">.</span><span class="n">must_record_gradient</span><span class="p">():</span>
    <span class="n">_execute</span><span class="o">.</span><span class="n">record_gradient</span><span class="p">(</span>
        <span class="s2">&quot;UnsortedSegmentJoin&quot;</span><span class="p">,</span> <span class="n">_inputs_flat</span><span class="p">,</span> <span class="n">_attrs</span><span class="p">,</span> <span class="n">_result</span><span class="p">)</span>
  <span class="n">_result</span><span class="p">,</span> <span class="o">=</span> <span class="n">_result</span>
  <span class="k">return</span> <span class="n">_result</span>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright - Wei MEI (Nick Cafferry).

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>